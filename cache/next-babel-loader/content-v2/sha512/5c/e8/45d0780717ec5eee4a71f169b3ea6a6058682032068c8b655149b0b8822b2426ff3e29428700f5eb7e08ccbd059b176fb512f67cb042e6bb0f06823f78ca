{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"/Users/justinjeong/Github/javascript/githubIo/client/components/Blog/CreatePage.js\",\n    _s = $RefreshSig$();\n\nimport React, { useCallback, useEffect, useMemo, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport Router, { useRouter } from 'next/router';\nimport { Typography, Form, Button, message as Message, Input, Space, Select, Divider } from 'antd';\nimport { PlusOutlined } from '@ant-design/icons';\nimport { CREATE_BLOG_POST_REQUEST, RESET_CREATE_BLOG_POST } from '../../reducers/types';\nimport QuillEditor from './Editor/QuillEditor';\nconst {\n  Title\n} = Typography;\nconst {\n  Option\n} = Select;\n\nfunction CreatePage() {\n  _s();\n\n  const dispatch = useDispatch();\n  const router = useRouter();\n  const {\n    0: content,\n    1: setContent\n  } = useState('');\n  const {\n    0: title,\n    1: setTitle\n  } = useState('');\n  const {\n    0: files,\n    1: setFiles\n  } = useState([]);\n  const {\n    0: newCategory,\n    1: setNewCategory\n  } = useState('');\n  const {\n    0: categories,\n    1: setCategories\n  } = useState(['자유게시판']);\n  const {\n    currentUser\n  } = useSelector(state => state.user);\n  const {\n    createBlogPostLoading,\n    createBlogPostDone,\n    uploadDataset,\n    uploadBlogDatasetLoading\n  } = useSelector(state => state.blog);\n  useEffect(() => {\n    if (createBlogPostDone) {\n      Message.success('게시글이 등록되었습니다.');\n      setTimeout(() => {\n        dispatch({\n          type: RESET_CREATE_BLOG_POST\n        });\n        Router.push('/blog');\n      }, 2000);\n    }\n  }, [dispatch, createBlogPostDone]);\n  const onSubmit = useCallback(() => {\n    if (title === '') return Message.error('제목을 작성해주세요.');\n    if (content === '') return Message.error('내용을 작성해주세요.');\n    dispatch({\n      type: CREATE_BLOG_POST_REQUEST,\n      payload: {\n        content: content,\n        title: title,\n        writer: currentUser.userId,\n        files: uploadDataset.files\n      }\n    });\n    setContent('');\n  }, [title, content, currentUser, uploadDataset]);\n  const isAdmin = useCallback(() => {\n    return currentUser.role === 1;\n  }, [currentUser]);\n  const onEditorChange = useCallback(value => {\n    setContent(value);\n  }, []);\n  const onFilesChange = useCallback(files => {\n    setFiles(files);\n  }, []);\n  const onChangeTitle = useCallback(event => {\n    setTitle(event.target.value);\n  }, []);\n  const handleAddCategory = useCallback(() => {\n    if (!newCategory.trim()) {\n      return setNewCategory('');\n    }\n\n    if (categories.includes(newCategory)) {\n      return Message.error('이미 존재하는 블로그 분류입니다.');\n    }\n\n    setCategories(prev => [...prev, newCategory]);\n    setNewCategory('');\n  }, [newCategory]);\n  const handleCancel = useCallback(() => {\n    router.back();\n  }, []);\n  const handleCategory = useCallback(event => {\n    setNewCategory(event.currentTarget.value);\n  }, []);\n  const renderCategory = useCallback(() => categories.map(category => {\n    return /*#__PURE__*/_jsxDEV(Option, {\n      children: category\n    }, category, false, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 12\n    }, this);\n  }), [categories]);\n  const formWrapperStyle = useMemo(() => ({\n    display: 'flex'\n  }), []);\n  const selectorStyle = useMemo(() => ({\n    width: 240\n  }), []);\n  const selectorDividerStyle = useMemo(() => ({\n    margin: '4px 0'\n  }), []);\n  const categoryWrapperStyle = useMemo(() => ({\n    display: 'flex',\n    flexWrap: 'nowrap',\n    padding: 8\n  }), []);\n  const categoryInputStyle = useMemo(() => ({\n    width: '75%'\n  }), []);\n  const spaceStyle = useMemo(() => ({\n    textAlign: 'end',\n    marginTop: '1rem'\n  }), []);\n  const plusButtonWrapperStyle = useMemo(() => ({\n    marginTop: 5\n  }), []);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      width: '75%',\n      margin: 'auto'\n    },\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        textAlign: 'center',\n        paddingTop: 100\n      },\n      children: /*#__PURE__*/_jsxDEV(Title, {\n        level: 2,\n        children: \"\\uBE14\\uB85C\\uADF8 \\uAE00 \\uC791\\uC131\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Form, {\n      onFinish: onSubmit,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        style: formWrapperStyle,\n        children: [/*#__PURE__*/_jsxDEV(Input, {\n          value: title,\n          onChange: onChangeTitle,\n          placeholder: \"\\uC81C\\uBAA9\\uC744 \\uC785\\uB825\\uD558\\uC138\\uC694\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 108,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Select, {\n          disabled: !isAdmin,\n          defaultValue: '자유게시판',\n          style: selectorStyle,\n          dropdownRender: menu => /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [menu, /*#__PURE__*/_jsxDEV(Divider, {\n              style: selectorDividerStyle\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 116,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              style: categoryWrapperStyle,\n              children: [/*#__PURE__*/_jsxDEV(Input, {\n                style: categoryInputStyle,\n                value: newCategory,\n                onChange: handleCategory\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 118,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                style: plusButtonWrapperStyle,\n                children: [/*#__PURE__*/_jsxDEV(PlusOutlined, {\n                  onClick: handleAddCategory\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 120,\n                  columnNumber: 21\n                }, this), \"\\uCD94\\uAC00\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 119,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 117,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 114,\n            columnNumber: 15\n          }, this),\n          children: renderCategory\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(QuillEditor, {\n        placeholder: '블로그 글을 작성해주세요.',\n        onEditorChange: onEditorChange,\n        onFilesChange: onFilesChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Space, {\n        style: spaceStyle,\n        children: [/*#__PURE__*/_jsxDEV(Button, {\n          htmlType: \"submit\",\n          type: \"primary\",\n          onSubmit: onSubmit,\n          disabled: createBlogPostLoading,\n          loading: createBlogPostLoading || uploadBlogDatasetLoading,\n          children: \"\\uAE00\\uC4F0\\uAE30\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: handleCancel,\n          children: \"\\uCDE8\\uC18C\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 101,\n    columnNumber: 5\n  }, this);\n}\n\n_s(CreatePage, \"riA2pg+gJhduof+2pqCrS6Z94Eo=\", false, function () {\n  return [useDispatch, useRouter, useSelector, useSelector];\n});\n\n_c = CreatePage;\nexport default CreatePage;\n\nvar _c;\n\n$RefreshReg$(_c, \"CreatePage\");","map":{"version":3,"sources":["/Users/justinjeong/Github/javascript/githubIo/client/components/Blog/CreatePage.js"],"names":["React","useCallback","useEffect","useMemo","useState","useDispatch","useSelector","Router","useRouter","Typography","Form","Button","message","Message","Input","Space","Select","Divider","PlusOutlined","CREATE_BLOG_POST_REQUEST","RESET_CREATE_BLOG_POST","QuillEditor","Title","Option","CreatePage","dispatch","router","content","setContent","title","setTitle","files","setFiles","newCategory","setNewCategory","categories","setCategories","currentUser","state","user","createBlogPostLoading","createBlogPostDone","uploadDataset","uploadBlogDatasetLoading","blog","success","setTimeout","type","push","onSubmit","error","payload","writer","userId","isAdmin","role","onEditorChange","value","onFilesChange","onChangeTitle","event","target","handleAddCategory","trim","includes","prev","handleCancel","back","handleCategory","currentTarget","renderCategory","map","category","formWrapperStyle","display","selectorStyle","width","selectorDividerStyle","margin","categoryWrapperStyle","flexWrap","padding","categoryInputStyle","spaceStyle","textAlign","marginTop","plusButtonWrapperStyle","paddingTop","menu"],"mappings":"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","sourcesContent":["import React, { useCallback, useEffect, useMemo, useState } from 'react'\nimport { useDispatch, useSelector } from 'react-redux';\nimport Router, { useRouter } from 'next/router'\nimport { Typography, Form, Button, message as Message, Input, Space, Select, Divider } from 'antd'\nimport { PlusOutlined } from '@ant-design/icons';\nimport { CREATE_BLOG_POST_REQUEST, RESET_CREATE_BLOG_POST } from '../../reducers/types'\nimport QuillEditor from './Editor/QuillEditor'\nconst { Title } = Typography;\nconst { Option } = Select;\n\nfunction CreatePage() {\n\n  const dispatch = useDispatch();\n  const router = useRouter();\n  const [content, setContent] = useState('')\n  const [title, setTitle] = useState('')\n  const [files, setFiles] = useState([]);\n  const [newCategory, setNewCategory] = useState('');\n  const [categories, setCategories] = useState(['자유게시판']);\n\n  const { currentUser } = useSelector(state => state.user)\n  const { createBlogPostLoading, createBlogPostDone, uploadDataset, uploadBlogDatasetLoading } = useSelector(state => state.blog)\n\n  useEffect(() => {\n    if (createBlogPostDone) {\n      Message.success('게시글이 등록되었습니다.')\n      setTimeout(() => {\n        dispatch({\n          type: RESET_CREATE_BLOG_POST\n        })\n        Router.push('/blog')\n      }, 2000)\n    }\n  }, [dispatch, createBlogPostDone])\n\n  const onSubmit = useCallback(() => {\n    if (title === '') return Message.error('제목을 작성해주세요.');\n    if (content === '') return Message.error('내용을 작성해주세요.');\n\n    dispatch({\n      type: CREATE_BLOG_POST_REQUEST,\n      payload: {\n        content: content,\n        title: title,\n        writer: currentUser.userId,\n        files: uploadDataset.files\n      },\n    })\n    setContent('');\n  }, [title, content, currentUser, uploadDataset])\n\n  const isAdmin = useCallback(() => {\n    return currentUser.role === 1\n  }, [currentUser])\n\n  const onEditorChange = useCallback((value) => {\n    setContent(value)\n  }, [])\n\n  const onFilesChange = useCallback((files) => {\n    setFiles(files)\n  }, [])\n\n  const onChangeTitle = useCallback((event) => {\n    setTitle(event.target.value);\n  }, [])\n\n  const handleAddCategory = useCallback(() => {\n    if (!newCategory.trim()) {\n      return setNewCategory('');\n    }\n    if (categories.includes(newCategory)) {\n      return Message.error('이미 존재하는 블로그 분류입니다.')\n    }\n    setCategories(prev => [...prev, newCategory]);\n    setNewCategory('')\n  }, [newCategory])\n\n  const handleCancel = useCallback(() => {\n    router.back()\n  }, [])\n\n  const handleCategory = useCallback((event) => {\n    setNewCategory(event.currentTarget.value)\n  }, [])\n\n  const renderCategory = useCallback(() => categories.map((category) => {\n    return <Option key={category}>{category}</Option>\n  }), [categories])\n\n  const formWrapperStyle = useMemo(() => ({ display: 'flex', }), [])\n  const selectorStyle = useMemo(() => ({ width: 240 }), [])\n  const selectorDividerStyle = useMemo(() => ({ margin: '4px 0' }), [])\n  const categoryWrapperStyle = useMemo(() => ({ display: 'flex', flexWrap: 'nowrap', padding: 8 }), [])\n  const categoryInputStyle = useMemo(() => ({ width: '75%' }), [])\n  const spaceStyle = useMemo(() => ({ textAlign: 'end', marginTop: '1rem' }), [])\n  const plusButtonWrapperStyle = useMemo(() => ({ marginTop: 5 }), [])\n\n\n  return (\n    <div style={{ width: '75%', margin: 'auto' }}>\n      <div style={{ textAlign: 'center', paddingTop: 100 }}>\n        <Title level={2} >블로그 글 작성</Title>\n      </div>\n\n      <Form onFinish={onSubmit}>\n        <div style={formWrapperStyle}>\n          <Input value={title} onChange={onChangeTitle} placeholder='제목을 입력하세요' />\n          <Select\n            disabled={!isAdmin}\n            defaultValue={'자유게시판'}\n            style={selectorStyle}\n            dropdownRender={menu => (\n              <div>\n                {menu}\n                <Divider style={selectorDividerStyle} />\n                <div style={categoryWrapperStyle}>\n                  <Input style={categoryInputStyle} value={newCategory} onChange={handleCategory} />\n                  <span style={plusButtonWrapperStyle}>\n                    <PlusOutlined onClick={handleAddCategory} />추가\n                  </span>\n                </div>\n              </div>\n            )}\n          >\n            {renderCategory}\n          </Select>\n        </div>\n\n        <QuillEditor\n          placeholder={'블로그 글을 작성해주세요.'}\n          onEditorChange={onEditorChange}\n          onFilesChange={onFilesChange}\n        />\n\n        <Space style={spaceStyle}>\n          <Button\n            htmlType='submit'\n            type='primary'\n            onSubmit={onSubmit}\n            disabled={createBlogPostLoading}\n            loading={createBlogPostLoading || uploadBlogDatasetLoading}\n          >글쓰기</Button>\n          <Button onClick={handleCancel}>취소</Button>\n        </Space>\n      </Form>\n    </div>\n  )\n}\n\nexport default CreatePage;\n"]},"metadata":{},"sourceType":"module"}